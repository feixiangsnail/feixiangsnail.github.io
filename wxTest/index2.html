<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>微信测试</title>
    <script src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
</head>

<body>
</body>
<script src="js/jquery.js"></script>
<script src="js/axios.min.js"></script>
<script src="js/debug.js"></script>
<!-- <script src="js/wxTest.js"></script> -->
<script>
//debug.log(document.cookie,'cookies');

//appid:wx83f2773ff212dde3
//secret:e9d4406f4f0eb1e23b8a6bce2cda4c91
// 172.104.32.98 demo demo123
//45.125.217.130
//ssh root@172.104.32.98
// root:baG6G7gweI7tT78f6g97G79
// mysql : asaiw48!skdhw1223





// if (!wx) {
//  console.log("微信接口调用失败");
// }

// var that = this;
// https://open.weixin.qq.com/connect/oauth2/authorize?

appid = wx83f2773ff212dde3 & redirect_uri = nrf163.com & response_type = code & scope = snsapi_userinfo & state = STATE# wechat_redirect
// axios.get("https://api.weixin.qq.com/cgi-bin/token?

grant_type = client_credential & appid = wx83f2773ff212dde3 & secret = e9d4406f4f0eb1e23b8a6bce2cda4c91 ").then((data) => {
//  debug.log(data, 'data');
//  console.log(data);
// }).catch((res) => {

//  debug.log('调用失败')
//  alert('diaoyongshibai')
// });


// axios.get("https://open.weixin.qq.com/connect/oauth2/authorize?

appid = wx83f2773ff212dde3 & redirect_uri = http: //mda2222.com/wxTest/getUserInfo.php&response_type=code&scope=snsapi_base&state=STATE#wecha

    t_redirect ").then((data) => {
    //  debug.log(data, 'data22')
    //  console.log(data);
    // }).catch((res) => {

    //  debug.log('调用失败')
    //  console.log('diaoyongshibai22')
    // });
    // axios.get('./getUserInfo.php').then((data)=>{
    //  debug.log(data, 'data22')
    //  console.log(data);
    // }).catch((res)=>{
    //  debug.log(res,'失败');

    // })

    // $(function () {
    //  $.ajax({
    //      type: "get",
    //      data: null,
    //      url: "getUserInfo.php",
    //      //url: "testdata.php",
    //      dataType: "text",
    //      timeout: 10000,
    //      success: function (d) {
    //          debug.log(d, 'chengong')
    //      },
    //      error: function (XMLHttpRequest, textStatus, errorThrown) {
    //          debug.log(XMLHttpRequest);
    //          debug.log('失败')
    //          debug.log(textStatus);
    //          debug.log('---')
    //          debug.log(errorThrown);
    //      }
    //  });
    // })

    // window.location.href= 'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx83f2773ff212dde3&redirect_uri=http%3A%2F

    %
    2 Fmda2222.com % 2 Fwechat % 2 Fv1 % 2 FGetcode & response_type = code & scope = snsapi_userinfo & state = 123 dd123 & connect_redirect = 1# wechat_redirect ';

// $(function () {
//  $.ajax({
//      type: "get",
//      data: null,
//      url: "https://open.weixin.qq.com/connect/oauth2/authorize?

appid = wx83f2773ff212dde3 & redirect_uri = http: //mda2222.com/index.html&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redire

    ct ",
//      //url: "testdata.php",
//      dataType: "text",
//      timeout: 10000,
//      success: function (d) {
//          debug.log(d, 'chengong')
//          console.log(d,'dd')
//      },
//      error: function (XMLHttpRequest, textStatus, errorThrown) {
//          debug.log(XMLHttpRequest);
//          debug.log('失败')
//          debug.log(textStatus);
//          debug.log('---')
//          debug.log(errorThrown);
//      }
//  });
// })






// debug.log('isWeixin')

// if (window.location.href) {
//     debug.log(getCookie("token"))

// } else {
//     debug.log('noToken')

//     window.location.href =
//         "https://open.weixin.qq.com/connect/oauth2/authorize?

appid = wx83f2773ff212dde3 & redirect_uri = http: //mda2222.com/wechat/v1/GetWechatUserInfo&response_type=code&scope=snsapi_userinfo&state=ht

    tp: //mda2222.com:8080/wxTest/index.html&connect_redirect=1#wechat_redirect";


    // }



    // var urlIndex = window.location.href.indexOf('token=')
    // if (urlIndex != -1) {
    //     debug.log('登录成功');
    //    // var tempUrl = window.location.href;

    //     var token = window.location.href.substring(urlIndex + 6);
    //    // sessionStorage.setItem('wxToken', token);
    //     debug.log(token);
    //    document.write(token);
    // } else {
    //     debug.log('正在跳转到微信认证')
    //     window.location.href =
    //         "https://open.weixin.qq.com/connect/oauth2/authorize?

    appid = wx83f2773ff212dde3 & redirect_uri = http: //mda2222.com/wechat/v1/GetWechatUserInfo&response_type=code&scope=snsapi_userinfo&state=ht

    tp: //mda2222.com:8080/wxTest/index.html&connect_redirect=1#wechat_redirect";
    // }




    // $.ajax({
    //         type: "post",
    //         data: {token:'e5f747f3-5a8b-11e8-8e59-6adb43a2'},
    //         url: "http://mda2222.com/wechat/v1/GetUserInfo",
    //         dataType: "json",
    //         timeout: 10000,
    //         success: function(d) {
    //           console.log(d,'dlogin')
    //           debug.log(d)

    //         },
    //         error: function(XMLHttpRequest, textStatus, errorThrown) {
    //           debug.log(XMLHttpRequest);
    //           debug.log(textStatus);
    //           debug.log(errorThrown);
    //         }
    //       });

    // p('http://mda2222.com/wechat/v1/GetUserInfo',{'token':'e5f747f3-5a8b-11e8-8e59-6adb43a2'}).then(function(d){
    //  console.log(d);
    //  document.write(d);
    // }).catch(function(x,y){
    //  console.log(x,y)
    // })



    // function p(url, data) {

    //     return axios({
    //         method: 'post',
    //         url: url,
    //         data: data,
    //         timeout: 30000,
    //         withCredentials: true,
    //         responseType: 'json',
    //         headers: {
    //             'Content-Type': 'application/json;charset=UTF-8'
    //         }
    //     })
    // }



    if (!getCookie("wxUserInfo")) {
        debug.log('失败');
        window.location.href = 'https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx83f2773ff212dde3&redirect_uri=http://mda2222.com/wxTest/getUserInfo.php&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect';
    } else {

        debug.log(getCookie("wxUserInfo"));
        document.write(getCookie("wxUserInfo"))
    }


function getCookie(name) {
    var arr = document.cookie.match(new RegExp("(^| )" + name + "=([^;]*)(;|$)"));
    if (arr != null) return unescape(arr[2]);
    return null;
}
</script>

</html>